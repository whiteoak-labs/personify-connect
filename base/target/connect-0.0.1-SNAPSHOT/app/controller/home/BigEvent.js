Ext.define("Personify.controller.home.BigEvent",{extend:"Personify.base.Controller",requires:["Ext.util.DelayedTask"],control:{carouselImg:{show:"onShowImage",activeitemchange:"onActiveItemChange"}},config:{featuredEventsData:null,orientation:null},init:function(){var a=this;this.onShowImage();Ext.Viewport.setListeners({orientationchange:{fn:a.onOrientationChange,scope:a}});a.setOrientation(Ext.Viewport.getOrientation());this.onLoadFeaturedEvents()},onLoadFeaturedEvents:function(){var a=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("featuredEvents");this.setFeaturedEventsData(a);this.setDataCarousel()},onOrientationChange:function(a,b){this.setOrientation(b);this.setDataCarousel()},setDataCarousel:function(){var d=this,f=this.getCarouselImg(),e=this.getFeaturedEventsData(),a=this.getOrientation();f.removeAll(true);for(var b=0;b<e.length;b++){var g=null;if(a=="portrait"){g=e[b].TabletPortraitImageURL}else{g=e[b].TabletLandscapeImageURL}var c=Ext.create("Ext.Img",{src:g,layout:"fit",record:e[b]});c.on({tap:{fn:d.onOpenEventPage,scope:d,item:e[b]}});f.add(c)}f.setActiveItem(0)},onOpenEventPage:function(d){var c=this;var e=d.config.record;if(!e.ProductId){return}var b=null;var a=Ext.getStore("meetingListtingMain");a.each(function(f){if(f.get("productID")==e.ProductId){b=f}});if(b){c.getView().fireEvent("onEventItemTapped",b)}},destroy:function(){var b=this.getCarouselImg(),a=this;Ext.Viewport.removeListener({orientationchange:{fn:a.onOrientationChange,scope:a}});if(b.pageTurner){b.pageTurner.cancel()}return this.callParent(arguments)},onShowImage:function(){var a=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("featuredEventsRotation");var b=this.getCarouselImg();if(!b.pageTurner){b.pageTurner=new Ext.util.DelayedTask(function(){if(b.getActiveIndex()==b.items.length-1){b.setActiveItem(0,{type:"slide",direction:"right",duration:a*1000})}else{b.next()}},b)}b.pageTurner.delay(a*1000)},onActiveItemChange:function(){var a=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("featuredEventsRotation");var b=this.getCarouselImg();b.pageTurner.delay(a*1000)}});