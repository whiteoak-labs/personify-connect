Ext.define("Personify.controller.main.MenuBar",{extend:"Personify.base.Controller",inject:["currentUser"],config:{currentUser:null},control:{topMenubarButton:{onmenutap:"onOpenMenuBar",onnotificationtap:"onNotificationButton",ontapcartitemcheckout:"onTapCartItemCheckout"},bottomMenuButton:{onmenutap:"onCloseMenuBar",onnotificationtap:"onNotificationButton",ontapcartitemcheckout:"onTapCartItemCheckout"},menubarListItems:{openmainview:"openMainPage",openinfopage:"openInfoPage",onmenuitem:"onMenuItemTap"},expandedMenu:true},init:function(){this.callParent(arguments)},destroy:function(){this.getBottomMenuButton().setShowAnimation(null);this.getExpandedMenu().setShowAnimation(null);this.getExpandedMenu().setHideAnimation(null);return this.callParent(arguments)},updateMenuList:function(b){var e=false;var a=b.getData().all;this.getMenubarListItems().getController().setMenuStore(b);for(var c=0,d=a.length;c<d;c++){if(a[c].get("view")=="Personify.view.Store"){e=true;break}}this.getTopMenubarButton().getController().setEnableShoppingCart(e);this.getBottomMenuButton().getController().setEnableShoppingCart(e);this.getView().setActiveItem(0)},openInfoPage:function(){var a=this.getView().getParent();var b=Ext.create("Personify.view.Help");Ext.Viewport.add(b);b.show();this.onCloseMenuBar();this.getMenubarListItems().getController().selectBtn("info")},openMainPage:function(){var a=this.getView().getParent();a.getController().openView("Personify.view.Home",null,"Main","homemenuitem");a.getController().updateViewModules();this.resetSelectedButton();this.getMenubarListItems().getController().selectBtn("main")},resetSelectedButton:function(){this.onCloseMenuBar();this.getMenubarListItems().getController().resetSelectedButton()},onMenuItemTap:function(b){if(!Personify.utils.PhoneGapHelper.checkConnection()&&b.get("name")!="Events"){Ext.Viewport.setMasked(false);Ext.Msg.alert("Connection","Please check your internet connection.",Ext.emptyFn);return}var a=Personify.utils.Configuration.getCurrentUser();var c=a?a.isLogged():false;if(b.get("neededLogin")&&!c){Personify.utils.ItemUtil.needToLogin();return}else{this.getView().fireEvent("openselectview",b.get("view"),{record:b,listeners:b.get("listeners")},b.get("title"),b.get("css"))}this.onCloseMenuBar()},onOpenMenuBar:function(){this.getView().setHeight(117);this.getView().setActiveItem(1);this.getMenubarListItems().show()},onCloseMenuBar:function(){Ext.callback(this.closeMenuBar,this,[],400)},closeMenuBar:function(){this.getView().setHeight(51);this.getView().setActiveItem(0)},setNotificationButton:function(a){this.getTopMenubarButton().getController().setNotificationValue(""+a);this.getBottomMenuButton().getController().setNotificationValue(""+a)},onNotificationButton:function(){if(!Personify.utils.PhoneGapHelper.checkConnection()){Ext.Msg.alert("Connection","Please check your internet connection.",Ext.emptyFn);return}var a=Personify.utils.Configuration.getCurrentUser();if(a.isLogged()){this.getView().fireEvent("onNotificationButton")}else{Personify.utils.ItemUtil.needToLogin();return}},disableNotificationButton:function(a){this.getTopMenubarButton().getController().disableNotificationButton(a);this.getBottomMenuButton().getController().disableNotificationButton(a)},onTapCartItemCheckout:function(){if(!Personify.utils.PhoneGapHelper.checkConnection()){Ext.Msg.alert("Connection","Please check your internet connection.",Ext.emptyFn);return}this.getView().fireEvent("ontapcartitemcheckout")}});