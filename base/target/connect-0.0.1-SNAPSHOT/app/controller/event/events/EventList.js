Ext.define("Personify.controller.event.events.EventList",{extend:"Personify.base.Controller",control:{},init:function(){},setStore:function(b){if(!b){this.getView().setStore(null);return}b.sort({sorterFn:function(e,d){var c=Personify.utils.ItemUtil.convertStringToDate(e.get("startDateTimeString"));var h=Personify.utils.ItemUtil.convertStringToDate(d.get("startDateTimeString"));var g=c;var f=h;return g>f?1:(g==f?0:-1)},direction:"ASC"});b.setGrouper({groupFn:function(d){var c=Personify.utils.ItemUtil.convertStringToDate(d.get("startDateTimeString"));var f=Personify.utils.ItemUtil.getMonthEventView(c);var g=Ext.Date.format(c,"m");var e=Personify.utils.ItemUtil.getYearEventView(c);return'<span style="color:transparent;display:none!important">'+e+","+g+"</span>"+f+" "+e}});b.setRemoteFilter(false);var a=this.getView();if(a&&!a.isDestroyed){a.setStore(b)}this.hidePastEvent(b)},hidePastEvent:function(b){if(b&&b.getCount()>0){var a=new Array();b.each(function(c){var e=new Date();var d=Personify.utils.ItemUtil.convertStringToDate(c.get("startDateTimeString"));if(d.getFullYear()<e.getFullYear()){a.push(c)}else{if(d.getFullYear()==e.getFullYear()&&d.getMonth()<e.getMonth()){a.push(c)}}});this.getView().hiddenRecord(a)}},getThreeNextEvent:function(){var b=this.getView().getStore();var a=new Date();if(b){b.each(function(d){var e=Personify.utils.ItemUtil.convertStringToDate(d.get("endDateTimeString"));if(a>e){b.remove(d)}});for(var c=b.getAllCount();c>2;c--){b.removeAt(c)}}}});