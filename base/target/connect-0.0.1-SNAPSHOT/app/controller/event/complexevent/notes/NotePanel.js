Ext.define("Personify.controller.event.complexevent.notes.NotePanel",{extend:"Personify.base.Controller",config:{addButton:null},control:{addNotePanel:{addnotesuccess:"onAddNoteSuccess",canceladdnote:"onCancelAddNote"},viewNotePanel:{onloadnotes:"loadNoteList",addnewnote:"openAddNewNotePanel"},noteListPanel:{onloadnotes:"loadNoteList",onselectnote:"onSelectNote",oncleartextfields:"onClearTextFields",addnewnote:"openAddNewNotePanel"}},init:function(){var b=this.getView().getMeetingRecord()?this.getView().getMeetingRecord().get("productID"):null;var a=this.getView().getMeetingRecord().get("shortName");this.getViewNotePanel().getController().setNoteTitle(a);this.getViewNotePanel().getController().setEventId(b);this.loadNoteList()},onAddNoteSuccess:function(){this.loadNoteList()},openAddNewNotePanel:function(){var a=this.getView().getMeetingRecord().get("shortName");this.getViewNotePanel().getController().onClearTextFields();this.getViewNotePanel().getController().setNoteTitle(a);this.getViewNotePanel().getController().clearNoteId();this.loadNoteList(true)},onCancelAddNote:function(){this.getAddNotePanel().hide();this.getViewNotePanel().show()},loadNoteList:function(a){var e=this;var d=e.getView().getMeetingRecord()?e.getView().getMeetingRecord().get("productID"):null;var c={eventId:d};var f=Personify.utils.ServiceManager.getStoreManager();var b=Ext.create(f.getNoteListStore());b.setDataRequest(c);b.load({callback:function(h,g,i){e.getNoteListPanel().getController().setStore(b);if(a){}else{if(h.length>0){e.onSelectNote(h[0]);e.getNoteListPanel().getController().setSelectedItem(0)}}}})},onSelectNote:function(a){this.getViewNotePanel().getController().setRecord(a)},onClearTextFields:function(){this.getViewNotePanel().getController().onClearTextFields()}});