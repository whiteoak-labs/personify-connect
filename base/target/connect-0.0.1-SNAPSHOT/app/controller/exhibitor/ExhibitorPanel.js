Ext.define("Personify.controller.exhibitor.ExhibitorPanel",{extend:"Personify.base.Controller",control:{btnClearFilter:{tap:"onClearicontapEx"},searchFieldExhibitor:{seachclearicontap:"onClearicontapEx",onsearchtextchange:"onSearchExhibitorItem"},exhibitorList:{tapAllExhibitorItem:"ontapAllExhibitorItem",onTapBtnDelProductAllExhibitor:"onTapBtnDelProductAllExhibitor"}},init:function(){this.getSearchFieldExhibitor().getController().setPlaceHolder("Search Exhibitors or Booth Number")},setExhibitorStore:function(b){if(b){var c=b.getFilters();if(c.length>0){b.clearFilter()}var a=this.getView().getDefaultFilter();if(a){b.filter([a])}}this.getExhibitorList().setStore(b)},onSearchExhibitorItem:function(a){if(window.plugins.app47){window.plugins.app47.sendGenericEvent("Exhibitor Search")}var e=this.getExhibitorList().getStore();var d=[];var b=this.getView().getDefaultFilter();if(b){d.push(b)}var c=function(f){didMatch=(f.get("name").trim().toLowerCase()+" "+f.get("boothNos").trim().toLowerCase()+" ").match(a.trim().toLowerCase());if(didMatch){return f}};d.push(c);if(e){e.clearFilter();if(a.trim()!=""||a.trim()!=null){this.getBtnClearFilter().setDisabled(false);e.filter(d)}}},onClearicontapEx:function(){this.getExhibitorList().getStore().clearFilter();var a=this.getView().getDefaultFilter();if(a){this.getExhibitorList().getStore().filter([a])}this.getBtnClearFilter().setDisabled(true);this.getSearchFieldExhibitor().getController().clearSearchField();this.getExhibitorList().deselectAll()},ontapAllExhibitorItem:function(d,b,g,a,f,c){if(window.plugins.app47){window.plugins.app47.sendGenericEvent("Exhibitor Detail")}this.getView().getParent().fireEvent("onexhibitortap",a)},onTapBtnDelProductAllExhibitor:function(c){var f=this;var b=Personify.utils.Configuration.getCurrentUser();if(b&&b.isLogged()){var d=this.getExhibitorList().getStore(),h=c.get("recordId")||null,g=b.get("masterCustomerId")||null,a=b.get("subCustomerId")||null,e=f.getView().getRecord().get("productID")||null;if(!c.get("isAdded")){Personify.utils.Sqlite.insertTableExhibitor(h,e,g,a,function(i){if(i){c.set("isAdded",true);Ext.Msg.alert("","Exhibitor has been added to your exhibitors.",Ext.emptyFn);f.getView().fireEvent("updateAddMyScheduleButton",c)}else{Ext.Msg.alert("","Add Exhibitor Failed.",Ext.emptyFn)}})}else{Personify.utils.Sqlite.deleteMyExhibitor(h,e,g,a,function(i){if(i){c.set("isAdded",false);Ext.Msg.alert("","Exhibitor has been removed.",Ext.emptyFn);f.getView().fireEvent("updateAddMyScheduleButton",c)}else{Ext.Msg.alert("","Delete Exhibitor Failed.",Ext.emptyFn)}})}}else{Personify.utils.ItemUtil.needToLogin()}}});