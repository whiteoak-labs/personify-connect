Ext.define("Personify.store.jsonp.PurchaseHistory",{extend:"Personify.store.base.PurchaseHistory",requires:["Personify.model.jsonp.PurchaseHistory","Personify.store.jsonp.PurchaseList","Personify.store.jsonp.SubSystemList","Personify.proxy.RestService"],config:{storeId:"PurchaseHistory",model:"Personify.model.jsonp.PurchaseHistory",haveData:false,purchaseListStore:null,subSystemListStore:null,autoLoad:true,implicitIncludes:true,listeners:{beforeload:"onBeforeLoad",load:"loadData"}},onBeforeLoad:function(){var b=this.getDataRequest();var a={type:"restservice",url:Personify.utils.ServiceManager.getUrlWS("profilePurchases"),headers:Personify.utils.ServiceManager.getHeaders(),jsonData:b,reader:{type:"json"}};this.setProxy(a)},loadData:function(a,b){if(b.length>0){a.setPurchaseListStore(Ext.create("Personify.store.jsonp.PurchaseList"));if(a.getAt(0)!=null){a.getPurchaseListStore().add(a.getAt(0).PurchaseHistory.getData().items)}a.setSubSystemListStore(Ext.create("Personify.store.jsonp.SubSystemList"));if(a.getAt(0)!=null){a.getSubSystemListStore().add(a.getAt(0).SubSystemHistory.getData().items)}a.setHaveData(true)}}});