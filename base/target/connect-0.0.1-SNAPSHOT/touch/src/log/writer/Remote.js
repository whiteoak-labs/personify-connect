Ext.define("Ext.log.writer.Remote",{extend:"Ext.log.writer.Writer",requires:["Ext.Ajax"],config:{batchSendDelay:100,onFailureRetryDelay:500,url:""},isSending:false,sendingTimer:null,constructor:function(){this.queue=[];this.send=Ext.Function.bind(this.send,this);return this.callParent(arguments)},doWrite:function(b){var a=this.queue;a.push(b.message);if(!this.isSending&&this.sendingTimer===null){this.sendingTimer=setTimeout(this.send,this.getBatchSendDelay())}},send:function(){var a=this.queue,b=a.slice();a.length=0;this.sendingTimer=null;if(b.length>0){this.doSend(b)}},doSend:function(b){var a=this;a.isSending=true;Ext.Ajax.request({url:a.getUrl(),method:"POST",params:{messages:b.join("\n")},success:function(){a.isSending=false;a.send()},failure:function(){setTimeout(function(){a.doSend(b)},a.getOnFailureRetryDelay())},scope:a})}});