Ext.data.CSGenerator=Ext.extend(Ext.data.Config,{r:undefined,t:undefined,s:undefined,clock:undefined,local_offset:undefined,global_offset:undefined,constructor:function(a,c,b){Ext.apply(this,a);a.config_id="generator";Ext.data.CSGenerator.superclass.constructor.call(this,a);this.clock=this.clock||new Ext.data.Clock();this.t=this.t||this.clock.now();this.s=this.s||-1;this.local_offset=this.local_offset||0;this.global_offset=this.global_offset||0;this.writeAndCallback(true,c,b)},get:function(c,a){var b=this.clock.now();this.update_local_offset(b);this.s+=1;if(this.s>255){this.t=b;this.local_offset+=1;this.s=0}this.writeAndCallback(true,c,a);return new Ext.data.CS({r:this.r,t:this.global_time(),s:this.s})},seen:function(b,e,a){var d=false;var c=this.clock.now();if(c>this.t){d=this.update_local_offset(c)}d=d||this.update_global_offset(b);this.writeAndCallback(d,e,a)},setReplicaNumber:function(c,d,a){var b=this.r!==c;this.r=c;this.writeAndCallback(b,d,a)},update_local_offset:function(d){var c=false;var e=d-this.t;if(e>0){var b=this.global_time();this.t=d;if(e>this.local_offset){this.local_offset=0}else{this.local_offset-=e}var a=this.global_time();if(a>b){this.s=-1}c=true}else{if(e<0){this.t=d;this.local_offset+=-e;c=true}}return c},update_global_offset:function(c){var f=false;var d=new Ext.data.CS({r:this.r,t:this.global_time(),s:this.s+1});var e=d.t;var h=d.s;var a=c.t;var b=c.s;if(a==e&&b>=h){this.s=b;f=true}else{if(a>e){var g=a-e;if(g>this.global_offset){this.global_offset+=g;this.s=b;f=true}}}return f},global_time:function(){return this.t+this.local_offset+this.global_offset},as_data:function(){var a={r:this.r,t:this.t,s:this.s,local_offset:this.local_offset,global_offset:this.global_offset};a[Ext.data.SyncModel.MODEL]="Ext.data.CSGenerator";return Ext.data.CSGenerator.superclass.as_data.call(this,a)}});