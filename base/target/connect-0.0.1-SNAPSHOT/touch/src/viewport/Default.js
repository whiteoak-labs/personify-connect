Ext.define("Ext.viewport.Default",{extend:"Ext.Container",xtype:"viewport",PORTRAIT:"portrait",LANDSCAPE:"landscape",requires:["Ext.LoadMask","Ext.layout.Card","Ext.util.InputBlocker"],config:{autoMaximize:false,autoBlurInput:true,preventPanning:true,preventZooming:false,autoRender:true,layout:"card",width:"100%",height:"100%",useBodyElement:true,menus:{},orientation:null},getElementConfig:function(){var a=this.callParent(arguments);if(!Ext.feature.has.MatchMedia){a.children.unshift({reference:"orientationElement",className:"x-orientation-inspector"})}return a},isReady:false,isViewport:true,isMaximizing:false,id:"ext-viewport",isInputRegex:/^(input|textarea|select|a)$/i,isInteractiveWebComponentRegEx:/^(audio|video)$/i,focusedElement:null,fullscreenItemCls:Ext.baseCSSPrefix+"fullscreen",constructor:function(a){var b=Ext.Function.bind;this.doPreventPanning=b(this.doPreventPanning,this);this.doPreventZooming=b(this.doPreventZooming,this);this.doBlurInput=b(this.doBlurInput,this);this.maximizeOnEvents=["ready","orientationchange"];window.devicePixelRatio=window.devicePixelRatio||1;this.callSuper([a]);this.windowWidth=this.getWindowWidth();this.windowHeight=this.getWindowHeight();this.windowOuterHeight=this.getWindowOuterHeight();if(!this.stretchHeights){this.stretchHeights={}}if(Ext.feature.has.OrientationChange){this.addWindowListener("orientationchange",b(this.onOrientationChange,this))}else{this.addWindowListener("resize",b(this.onResize,this))}document.addEventListener("focus",b(this.onElementFocus,this),true);document.addEventListener("blur",b(this.onElementBlur,this),true);Ext.onDocumentReady(this.onDomReady,this);this.on("ready",this.onReady,this,{single:true});this.getEventDispatcher().addListener("component","*","fullscreen","onItemFullscreenChange",this);return this},onDomReady:function(){this.isReady=true;this.updateSize();this.fireEvent("ready",this)},onReady:function(){if(this.getAutoRender()){this.render()}if(Ext.browser.name=="ChromeiOS"){this.setHeight("-webkit-calc(100% - "+((window.outerHeight-window.innerHeight)/2)+"px)")}},onElementFocus:function(a){this.focusedElement=a.target},onElementBlur:function(){this.focusedElement=null},render:function(){if(!this.rendered){var a=Ext.getBody(),b=Ext.baseCSSPrefix,g=[],c=Ext.os,f=c.name.toLowerCase(),e=Ext.browser.name.toLowerCase(),d=c.version.getMajor();this.renderTo(a);g.push(b+c.deviceType.toLowerCase());if(c.is.iPad){g.push(b+"ipad")}g.push(b+f);g.push(b+e);if(d){g.push(b+f+"-"+d)}if(c.is.BlackBerry){g.push(b+"bb");if(Ext.browser.userAgent.match(/Kbd/gi)){g.push(b+"bb-keyboard")}}if(Ext.browser.is.WebKit){g.push(b+"webkit")}if(Ext.browser.is.Standalone){g.push(b+"standalone")}if(Ext.browser.is.AndroidStock){g.push(b+"android-stock")}if(Ext.browser.is.GoogleGlass){g.push(b+"google-glass")}this.setOrientation(this.determineOrientation());g.push(b+this.getOrientation());a.addCls(g)}},applyAutoBlurInput:function(a){var b=(Ext.feature.has.Touch)?"touchstart":"mousedown";if(a){this.addWindowListener(b,this.doBlurInput,false)}else{this.removeWindowListener(b,this.doBlurInput,false)}return a},applyAutoMaximize:function(a){if(Ext.browser.is.WebView){a=false}if(a){this.on("ready","doAutoMaximizeOnReady",this,{single:true});this.on("orientationchange","doAutoMaximizeOnOrientationChange",this)}else{this.un("ready","doAutoMaximizeOnReady",this);this.un("orientationchange","doAutoMaximizeOnOrientationChange",this)}return a},applyPreventPanning:function(a){if(a){this.addWindowListener("touchmove",this.doPreventPanning,false)}else{this.removeWindowListener("touchmove",this.doPreventPanning,false)}return a},applyPreventZooming:function(a){var b=(Ext.feature.has.Touch)?"touchstart":"mousedown";if(a){this.addWindowListener(b,this.doPreventZooming,false)}else{this.removeWindowListener(b,this.doPreventZooming,false)}return a},doAutoMaximizeOnReady:function(){var a=arguments[arguments.length-1];a.pause();this.isMaximizing=true;this.on("maximize",function(){this.isMaximizing=false;this.updateSize();a.resume();this.fireEvent("ready",this)},this,{single:true});this.maximize()},doAutoMaximizeOnOrientationChange:function(){var a=arguments[arguments.length-1],b=a.firingArguments;a.pause();this.isMaximizing=true;this.on("maximize",function(){this.isMaximizing=false;this.updateSize();b[2]=this.windowWidth;b[3]=this.windowHeight;a.resume()},this,{single:true});this.maximize()},doBlurInput:function(b){var a=b.target,c=this.focusedElement;if(c&&c.nodeName.toUpperCase()!="BODY"&&!this.isInputRegex.test(a.tagName)){delete this.focusedElement;c.blur()}},doPreventPanning:function(b){var a=b.target,c;if(this.isInteractiveWebComponentRegEx.test(a.tagName)&&b.touches&&b.touches.length>0){c=b.touches[0];if(c&&c.target&&this.isInputRegex.test(c.target.tagName)){return}}if(a&&a.nodeType===1&&!this.isInputRegex.test(a.tagName)){b.preventDefault()}},doPreventZooming:function(b){if("button" in b&&b.button!==0){return}var a=b.target,c;if(this.isInteractiveWebComponentRegEx.test(a.tagName)&&b.touches&&b.touches.length>0){c=b.touches[0];if(c&&c.target&&this.isInputRegex.test(c.target.tagName)){return}}if(a&&a.nodeType===1&&!this.isInputRegex.test(a.tagName)){b.preventDefault()}},addWindowListener:function(b,c,a){window.addEventListener(b,c,Boolean(a))},removeWindowListener:function(b,c,a){window.removeEventListener(b,c,Boolean(a))},doAddListener:function(a,d,c,b){if(a==="ready"&&this.isReady&&!this.isMaximizing){d.call(c);return this}return this.callSuper(arguments)},determineOrientation:function(){if(Ext.feature.has.Orientation){var a=this.getWindowOrientation();if(Math.abs(a)===90||a===270){return this.LANDSCAPE}else{return this.PORTRAIT}}else{if(Ext.feature.has.MatchMedia){return window.matchMedia("(orientation : landscape)").matches?this.LANDSCAPE:this.PORTRAIT}else{if(this.orientationElement){return this.orientationElement.getStyle("content")}}}},updateOrientation:function(b,a){if(a){this.fireOrientationChangeEvent(b,a)}},onOrientationChange:function(){this.setOrientation(this.determineOrientation())},onResize:function(){this.updateSize();this.setOrientation(this.determineOrientation())},fireOrientationChangeEvent:function(b,c){var a=Ext.baseCSSPrefix;Ext.getBody().replaceCls(a+c,a+b);this.updateSize();this.fireEvent("orientationchange",this,b,this.windowWidth,this.windowHeight)},updateSize:function(b,a){this.windowWidth=b!==undefined?b:this.getWindowWidth();this.windowHeight=a!==undefined?a:this.getWindowHeight();return this},maximize:function(){this.fireMaximizeEvent()},fireMaximizeEvent:function(){this.updateSize();this.fireEvent("maximize",this)},doSetHeight:function(a){Ext.getBody().setHeight(a);this.callParent(arguments)},doSetWidth:function(a){Ext.getBody().setWidth(a);this.callParent(arguments)},scrollToTop:function(){window.scrollTo(0,-1)},getWindowWidth:function(){return window.innerWidth},getWindowHeight:function(){return window.innerHeight},getWindowOuterHeight:function(){return window.outerHeight},getWindowOrientation:function(){return window.orientation},getSize:function(){return{width:this.windowWidth,height:this.windowHeight}},onItemFullscreenChange:function(a){a.addCls(this.fullscreenItemCls);this.add(a)},waitUntil:function(h,e,g,a,f){if(!a){a=50}if(!f){f=2000}var c=this,b=0;setTimeout(function d(){b+=a;if(h.call(c)===true){if(e){e.call(c)}}else{if(b>=f){if(g){g.call(c)}}else{setTimeout(d,a)}}},a)},setMenu:function(e,a){var b=this;a=a||{};if(Ext.os.is.iOS&&!this.hasiOSOrientationFix){this.hasiOSOrientationFix=true;this.on("orientationchange",function(){window.scrollTo(0,0)},this)}if(!e){Ext.Logger.error("You must specify a side to dock the menu.");return}if(!a.side){Ext.Logger.error("You must specify a side to dock the menu.");return}if(["left","right","top","bottom"].indexOf(a.side)==-1){Ext.Logger.error("You must specify a valid side (left, right, top or botom) to dock the menu.");return}var d=b.getMenus();if(!d){d={}}if(!b.addedSwipeListener){b.addedSwipeListener=true;b.element.on({tap:b.onTap,swipestart:b.onSwipeStart,edgeswipestart:b.onEdgeSwipeStart,edgeswipe:b.onEdgeSwipe,edgeswipeend:b.onEdgeSwipeEnd,scope:b});if(window.blackberry){var c=function(){var f=b.getMenus(),g=f.top;if(!g){return}if(g.isHidden()){b.showMenu("top")}else{b.hideMenu("top")}};if(blackberry.app&&blackberry.app.event&&blackberry.app.event.onSwipeDown){blackberry.app.event.onSwipeDown(c)}else{if(blackberry.event&&blackberry.event.addEventListener){blackberry.event.addEventListener("swipedown",c)}}}}d[a.side]=e;e.$reveal=Boolean(a.reveal);e.$cover=a.cover!==false&&!e.$reveal;e.$side=a.side;b.fixMenuSize(e,a.side);if(a.side=="left"){e.setLeft(0);e.setRight(null);e.setTop(0);e.setBottom(0)}else{if(a.side=="right"){e.setLeft(null);e.setRight(0);e.setTop(0);e.setBottom(0)}else{if(a.side=="top"){e.setLeft(0);e.setRight(0);e.setTop(0);e.setBottom(null)}else{if(a.side=="bottom"){e.setLeft(0);e.setRight(0);e.setTop(null);e.setBottom(0)}}}}b.setMenus(d)},removeMenu:function(a){var b=this.getMenus()||{},c=b[a];if(c){this.hideMenu(a)}delete b[a];this.setMenus(b)},fixMenuSize:function(b,a){if(a=="top"||a=="bottom"){b.setWidth("100%")}else{if(a=="left"||a=="right"){b.setHeight("100%")}}},showMenu:function(b){var e=this.getMenus(),h=e[b],d,g,f,c;if(!h||h.isAnimating){return}this.hideOtherMenus(b);d={translateX:0,translateY:0};g={translateX:0,translateY:0};f={translateX:0,translateY:0};c={translateX:0,translateY:0};if(h.$reveal){Ext.getBody().insertFirst(h.element)}else{Ext.Viewport.add(h)}h.show();h.addCls("x-"+b);var a=(b=="left"||b=="right")?h.element.getWidth():h.element.getHeight();if(b=="left"){d.translateX=-a;c.translateX=a}else{if(b=="right"){d.translateX=a;c.translateX=-a}else{if(b=="top"){d.translateY=-a;c.translateY=a}else{if(b=="bottom"){d.translateY=a;c.translateY=-a}}}}if(h.$reveal){if(Ext.browser.getPreferredTranslationMethod()!="scrollposition"){h.translate(0,0)}}else{h.translate(d.translateX,d.translateY)}if(h.$cover){h.getTranslatable().on("animationend",function(){h.isAnimating=false},this,{single:true});h.translate(g.translateX,g.translateY,{preserveEndState:true,duration:200})}else{this.translate(f.translateX,f.translateY);this.getTranslatable().on("animationend",function(){h.isAnimating=false},this,{single:true});this.translate(c.translateX,c.translateY,{preserveEndState:true,duration:200})}h.isAnimating=true},hideMenu:function(c,a){var e=this.getMenus(),g=e[c],f,d,b;a=(a===false)?false:true;if(!g||(g.isHidden()||g.isAnimating)){return}f={translateX:0,translateY:0};d={translateX:0,translateY:0};b=(c=="left"||c=="right")?g.element.getWidth():g.element.getHeight();if(c=="left"){f.translateX=-b}else{if(c=="right"){f.translateX=b}else{if(c=="top"){f.translateY=-b}else{if(c=="bottom"){f.translateY=b}}}}if(g.$cover){if(a){g.getTranslatable().on("animationend",function(){g.isAnimating=false;g.hide()},this,{single:true});g.translate(f.translateX,f.translateY,{preserveEndState:true,duration:200})}else{g.translate(f.translateX,f.translateY);g.hide()}}else{if(a){this.getTranslatable().on("animationend",function(){g.isAnimating=false;g.hide()},this,{single:true});this.translate(d.translateX,d.translateY,{preserveEndState:true,duration:200})}else{this.translate(d.translateX,d.translateY);g.hide()}}},hideAllMenus:function(c){var b=this.getMenus();for(var a in b){this.hideMenu(a,c)}},hideOtherMenus:function(a,c){var b=this.getMenus();for(var d in b){if(a!=d){this.hideMenu(d,c)}}},toggleMenu:function(a){var b=this.getMenus(),c;if(b[a]){c=b[a];if(c.isHidden()){this.showMenu(a)}else{this.hideMenu(a)}}},sideForDirection:function(a){if(a=="left"){return"right"}else{if(a=="right"){return"left"}else{if(a=="up"){return"bottom"}else{if(a=="down"){return"top"}}}}},sideForSwipeDirection:function(a){if(a=="up"){return"top"}else{if(a=="down"){return"bottom"}}return a},onTap:function(a){},onSwipeStart:function(b){var a=this.sideForSwipeDirection(b.direction);this.hideMenu(a)},onEdgeSwipeStart:function(h){var j=this.sideForDirection(h.direction),d=this.getMenus(),b=d[j],k,i;if(!b||!b.isHidden()){return}for(k in d){i=d[k];if(i.isHidden()!==false){return}}this.$swiping=true;this.hideAllMenus(false);if(b.$reveal){Ext.getBody().insertFirst(b.element)}else{Ext.Viewport.add(b)}b.show();var l=(j=="left"||j=="right")?b.element.getWidth():b.element.getHeight(),a,g;a={translateX:0,translateY:0};g={translateX:0,translateY:0};if(j=="left"){a.translateX=-l}else{if(j=="right"){a.translateX=l}else{if(j=="top"){a.translateY=-l}else{if(j=="bottom"){a.translateY=l}}}}var c="webkitTransform" in document.createElement("div").style?"webkitTransform":"transform",f=b.element.dom.style[c];if(f){b.element.dom.style[c]=""}if(b.$reveal){if(Ext.browser.getPreferredTranslationMethod()!="scrollposition"){b.translate(0,0)}}else{b.translate(a.translateX,a.translateY)}if(!b.$cover){if(f){this.innerElement.dom.style[c]=""}this.translate(g.translateX,g.translateY)}},onEdgeSwipe:function(g){var c=this.sideForDirection(g.direction),i=this.getMenus()[c];if(!i||!this.$swiping){return}var b=(c=="left"||c=="right")?i.element.getWidth():i.element.getHeight(),h,f,a=Math.min(g.distance-b,0),d=Math.min(g.distance,b);h={translateX:0,translateY:0};f={translateX:0,translateY:0};if(c=="left"){h.translateX=a;f.translateX=d}else{if(c=="right"){h.translateX=-a;f.translateX=-d}else{if(c=="top"){h.translateY=a;f.translateY=d}else{if(c=="bottom"){h.translateY=-a;f.translateY=-d}}}}if(i.$cover){i.translate(h.translateX,h.translateY)}else{this.translate(f.translateX,f.translateY)}},onEdgeSwipeEnd:function(i){var j=this.sideForDirection(i.direction),b=this.getMenus()[j],h=false;if(!b){return}var k=(j=="left"||j=="right")?b.element.getWidth():b.element.getHeight(),f=(i.flick)?i.flick.velocity:0;if(j=="right"){if(f.x>0){h=true}}else{if(j=="left"){if(f.x<0){h=true}}else{if(j=="top"){if(f.y<0){h=true}}else{if(j=="bottom"){if(f.y>0){h=true}}}}}var c=(h)?k:0,d=(h)?0:-k,a,g;a={translateX:0,translateY:0};g={translateX:0,translateY:0};if(j=="left"){a.translateX=-c;g.translateX=-d}else{if(j=="right"){a.translateX=c;g.translateX=d}else{if(j=="top"){a.translateY=-c;g.translateY=-d}else{if(j=="bottom"){a.translateY=c;g.translateY=d}}}}if(b.$cover){b.getTranslatable().on("animationend",function(){if(h){b.hide()}},this,{single:true});b.translate(a.translateX,a.translateY,{preserveEndState:true,duration:200})}else{this.getTranslatable().on("animationend",function(){if(h){b.hide()}},this,{single:true});this.translate(g.translateX,g.translateY,{preserveEndState:true,duration:200})}this.$swiping=false}});