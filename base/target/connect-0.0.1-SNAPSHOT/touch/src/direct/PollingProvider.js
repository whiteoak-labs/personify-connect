Ext.define("Ext.direct.PollingProvider",{extend:"Ext.direct.JsonProvider",alias:"direct.pollingprovider",uses:["Ext.direct.ExceptionEvent"],requires:["Ext.Ajax","Ext.util.DelayedTask"],config:{interval:3000,baseParams:null,url:null},isConnected:function(){return !!this.pollTask},connect:function(){var b=this,a=b.getUrl(),c=b.getBaseParams();if(a&&!b.pollTask){b.pollTask=setInterval(function(){if(b.fireEvent("beforepoll",b)!==false){if(Ext.isFunction(a)){a(c)}else{Ext.Ajax.request({url:a,callback:b.onData,scope:b,params:c})}}},b.getInterval());b.fireEvent("connect",b)}else{if(!a){Ext.Error.raise("Error initializing PollingProvider, no url configured.")}}},disconnect:function(){var a=this;if(a.pollTask){clearInterval(a.pollTask);delete a.pollTask;a.fireEvent("disconnect",a)}},onData:function(e,g,b){var f=this,d=0,a,c;if(g){c=f.createEvents(b);for(a=c.length;d<a;++d){f.fireEvent("data",f,c[d])}}else{f.fireEvent("data",f,Ext.create("Ext.direct.ExceptionEvent",{data:null,code:Ext.direct.Manager.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:b}))}}});