Ext.define("Personify.utils.ItemUtil",{xtype:"itemutil",requires:["Ext.MessageBox"],inject:["personify"],requires:["Ext.MessageBox"],config:{user:"abc",personify:null},statics:{searchItemsAndUpdateEditMode:function(e,f,b){try{e.setEditmode(f)}catch(d){try{var a=e.getItems().items;if(a.length!=0){for(var c=0;c<a.length;c++){this.searchItemsAndUpdateEditMode(a[c],f,b)}}}catch(d){}}},getDate:function(a){var b=a.replace("/Date(","");b=b.replace(")/","");return b},searchItemsAndSetParameter:function(e,f,b){try{e.setContactparameters(f)}catch(d){try{var a=e.getItems().items;if(a.length!=0){for(var c=0;c<a.length;c++){this.searchItemsAndSetParameter(a[c],f,b)}}}catch(d){}}},formatJSONFullDate:function(a){if(a!=null){var b=new Date(a);return Ext.Date.format(b,"M d, Y")}else{return""}},formatIso8601Date:function(b,c){var a="",d=c||"m/d/Y";if(b){a=Ext.Date.format(Personify.utils.ItemUtil.convertStringToDate(b),d)}return a},formatJSONDate:function(a,c){var b="",d=c||"m/d/Y";if(a){b=Ext.Date.format(new Date(a),d)}return b},formatPurchaseHistoryDate:function(a){var c=a.substring(0,10).split("-");var b=new Date(c[0],c[1],c[2]);return Ext.Date.format(b,"M d, Y")},formatParticipationDate:function(a,d){var c="unknow",e=d||"m/d/Y";if(a){var b=a.substring(0,10).split("-");c=Ext.Date.format(new Date(b[0],b[1],b[2]),e)}return c},formatContactTrackingDate:function(e){var d="";if(e){var b=e.substring(0,4);var c=e.substring(4,6);var a=e.substring(6,8);d=c+"/"+a+"/"+b}return d},formatDate:function(b){var a=new Date(b);return Ext.Date.format(a,"M. d, Y")},formatPurchaseAmount:function(e,c){var f=e.toString();var b;if(f.indexOf(".")!=-1){b=f.length-(f.indexOf(".")+1)}else{b=0;f=f+"."}var a=(c-b)>0?(c-b):0;for(var d=0;d<a;d++){f=f+"0"}while(/(\d+)(\d{3})/.test(f)){f=f.replace(/(\d+)(\d{3})/,"$1,$2")}return'<div style="float: left;">'+Personify.utils.Configuration.getConfiguration().getAt(0).ConfigStore.get("currencySymbol")+'</div><div style="float: right;">'+f+"&nbsp;"+Personify.utils.Configuration.getConfiguration().getAt(0).ConfigStore.get("currency")+"</div>"},formatOrderComfirmAmount:function(b,c){var a=Personify.utils.Configuration.getConfiguration().getAt(0).ConfigStore.get("currency");c=c.toFixed(2);var d=c.toString();while(/(\d+)(\d{3})/.test(d)){d=d.replace(/(\d+)(\d{3})/,"$1,$2")}return'<div style="float:left;">'+b+'</div><div style="float: right;">'+d+"&nbsp;"+a+"</div>"},checkStringNull:function(a){if(a==null||a==""){return""}else{return a}},displayImage:function(a){if(a==null||a==""){return"resources/icons/phone/defaultAvatar.png"}else{return a}},checkProductStatus:function(a){if(a){return(a=="A"||a=="")?"":'<div class="p-label-soldOut">Sold Out</div>'}else{return""}},getShortContent:function(d,b){var c=b;if(d.length<=b){return d}var a=d.substring(0,b);while((a.charAt(b-1)!=" ")&&(a.charAt(b-1)!=",")&&(a.charAt(b-1)!=".")&&(a.charAt(b-1)!="?")&&(b>0)){a=a.substring(0,--b)}if(d.length>c){a+=" ..."}return a},getReturnContent:function(a){while(a.indexOf("\n")!=-1){a=a.replace("\n","<br />")}return a},getDayEventView:function(a){return a.getDate()},getMonthEventView:function(a){return Ext.Date.format(a,"F")},getYearEventView:function(a){return a.getFullYear()},getHourEventView:function(a){return Ext.Date.format(a,"g:i A")},getDateEventView:function(a){return Ext.Date.format(a,"m/d/y")},formatXMLDate:function(a){return a},convertMilisecondToString:function(a,c){var b=new Date(a);return Ext.Date.format(b,c)},timeAgoInWords:function(b){try{var a=Math.ceil(Number(new Date())/1000),c=Math.ceil(Number(new Date(b))/1000),f=a-c,g;if(f<60){return String(f)+" seconds ago"}else{if(f<3600){g=String(Math.ceil(f/(60)));return g+(g=="1"?" minute":" minutes")+" ago"}else{if(f<86400){g=String(Math.ceil(f/(3600)));return g+(g=="1"?" hour":" hours")+" ago"}else{if(f<60*60*24*7){g=String(Math.ceil(f/(60*60*24)));return g+(g=="1"?" day":" days")+" ago"}else{if(f<60*60*24*30){g=String(Math.ceil(f/(60*60*24*7)));return g+(g=="1"?" week":" weeks")+" ago"}else{if(f<60*60*24*30*12){g=String(Math.ceil(f/(60*60*24*30)));return g+(g=="1"?" month":" months")+" ago"}else{return Ext.Date.format(new Date(b),"m/d/Y")}}}}}}}catch(d){return""}},getClsNotification:function(a){if(a){return"p-panel-notification-title-read"}else{return"p-panel-notification-title-noread"}},getClsTitleItemNotificationPhone:function(a){if(a){return"itemNotificationReadPhone"}else{return"itemNotificationUnReadPhone"}},convertMilisecondToDatePhone:function(a){var a=a.substr(a.indexOf("(")+1);a=a.substr(0,a.length-2);var c=new Date(parseInt(a));var b=new Date();var h=parseInt(b-c);var d=(h/(24*60*60*1000));var i=parseInt(d);var j=new Array();j[0]=i+" days ago...";if(parseInt(i)==1){j[0]=i+" day ago..."}var e=d-i;var g=e*24;var l=parseInt(g);var f=g-l;var m=f*60;var k=parseInt(m);j[1]=i+" Days "+l+" Hours "+k+" Minutes ago";return j},getFormattedNumber:function(a){if(parseInt(a)<10){a="0"+a.toString()}return a},getDisplaysStartTimeOrDateRange:function(b,a){if(Ext.Date.format(b,"m/d/y")==Ext.Date.format(a,"m/d/y")){return this.getHourEventView(b)+" - "+this.getHourEventView(a)}else{return this.getDateEventView(b)+" - "+this.getDateEventView(a)}},getDisplayTimeForEvent:function(e,d,b,a){var g=Personify.utils.ItemUtil.convertStringToDate(e);var c=Personify.utils.ItemUtil.convertStringToDate(d);if(Ext.Date.format(g,"m/d/y")==Ext.Date.format(c,"m/d/y")){if(a){return this.getDateEventView(g)}else{var f=this.getHourEventView(g)+"  - "+this.getHourEventView(c);if(b){f+=" "+b}return f}}else{return this.getDateEventView(g)+" - "+this.getDateEventView(c)}},getDisplaysTimeWithTimeZoneCode:function(b){var c=Personify.utils.ItemUtil.convertStringToDate(b.startDateTimeString);var a=Personify.utils.ItemUtil.convertStringToDate(b.endDateTimeString);if(Ext.Date.format(c,"m/d/y")==Ext.Date.format(a,"m/d/y")){if(b.isConference){return this.getDateEventView(c)}else{return this.getHourEventView(c)+"  - "+this.getHourEventView(a)+" "+b.timeZoneCode}}else{return this.getDateEventView(c)+" - "+this.getDateEventView(a)}},getDisplayDateTimeEventDetailPhone:function(f,c,a){var e="";var b="";var d="";if(Ext.Date.format(f,"m/d/y")==Ext.Date.format(c,"m/d/y")){e=this.getHourEventView(f);b=this.getHourEventView(c)+" "+a;d="<br>"+Ext.Date.format(f,"F d, Y");d=this.removeZero(d)}else{e=Ext.Date.format(f,"F d, Y");e=this.removeZero(e);b=Ext.Date.format(c,"F d, Y");b=this.removeZero(b)}return'<div class = "p-inlineblock"><b>'+e+'</b></div> - <div class = "p-inlineblock"><b>'+b+"</b></div>"+d},removeZero:function(c){var b=c.indexOf(",")-2;if(c&&c.charAt(b)=="0"){var a=c.substr(0,b);var d=c.substr(b+1,c.length-a.length-1);return a+d}else{return c}},getDaysBetweenTwoDates:function(c,a){var b=24*60*60*1000;var d=Math.round(Math.abs((c.getTime()-a.getTime())/(b)));if(c<a){d=-d}return d},getMonthsBetweenTwoDates:function(c,b){var a;a=(c.getFullYear()-b.getFullYear())*12;a-=b.getMonth();a+=c.getMonth();return a},onCheckedEmailValue:function(a){var b=/^([A-Za-z0-9_\-\.\+\!\#\$\%\&\'\*\+\-\/\=\?\^\_\`\{\|\}\~])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return b.test(a)},onCheckedPhoneValue:function(a){var b=/^\([0-9]{3,3}\)[\s]*[0-9]{3,3}\-[0-9]{4,4}$/;return b.test(a)},onCheckedUrlValue:function(a){var b=/^(http\:\/\/|https\:\/\/)?([a-z0-9][a-z0-9\-]*\.)+[a-z0-9][a-z0-9\-\/]*[a-z0-9]$/;return b.test(a)},onCheckedHourValue:function(b){var a=/^[0-1][0-9][\s]*[:][\s]*[0-5][0-9]$/;return a.test(b)},onClearFilterStore:function(a){if(a){a.each(function(b){b.set("checked","");if(b.SubcodeListEvent){b.SubcodeListEvent.each(function(c){c.set("checked","")})}})}},getTypeOfEvent:function(c){var a=Personify.utils.Configuration.getConfiguration();var b=a.getAt(0).EventsStore.get("types")[c];return b},getDates:function(f,e){var b=24*3600*1000;for(var g=[],a=f*1,c=e*1;a<=c;a+=b){g.push(new Date(a))}return g},removeImageHtmlContent:function(d){var b=document.createElement("DIV");b.innerHTML=d;var a=b.getElementsByTagName("img");for(var c=0;c<a.length;c++){b.removeChild(b.getElementsByTagName("img")[c])}return b.innerHTML},removeTagHtml:function(d,a){var b=document.createElement("DIV");b.innerHTML=d;var a=b.getElementsByTagName(a);for(var c=0;c<a.length;c++){b.removeChild(a[c])}return b.innerText},updateImageDimension:function(e){var b=document.createElement("DIV");b.innerHTML=e;var a=b.getElementsByTagName("img");for(var c=0,d=a.length;c<d;c++){a[c].removeAttribute("width");a[c].removeAttribute("height")}return b.innerHTML},needToLogin:function(){Ext.Msg.alert("","You need to log in to access this feature.",function(){var b=Ext.ComponentQuery.query("#loginPanel")[0];if(b){var a=b.getController();Ext.ComponentQuery.query("#loginButton")[0].fireEvent("submitLogin",a.getLoginButton())}else{Ext.ComponentQuery.query("#logInButton")[0].fireEvent("submitLogin")}})},getMeetingTagCls:function(a){if(a.trim()=="Sold Out"){return"p-label-soldOut"}else{if(a.trim()=="Cancelled"){return"p-label-cancelled"}else{if(a.trim()=="Wait List"){return"p-label-waitlist"}else{if(parseInt(a)>10){return""}else{return"p-label-event-normal"}}}}},getMeetingTag:function(a){if(a.trim()=="Sold Out"||a.trim()=="Cancelled"||a.trim()=="Wait List"){return a}else{if(parseInt(a)>10){return""}else{return a}}},cantLoadEvent:function(){Ext.Msg.alert("","Cannot load events.")},formatDateTimeSession:function(a){if(a){var b=new Date(a);return Ext.Date.format(b,"c")}else{return""}},formatDateMSMySchedule:function(a){if(a){var b=Ext.Date.parse(a,"MS");return Ext.Date.format(b,"c")}else{return""}},checkDateInDateArray:function(d,a){var c=new Array();for(var b=0;b<d.length;b++){c.push(Ext.Date.format(d[b],"m/d/y"))}return Ext.Array.contains(c,Ext.Date.format(a,"m/d/y"))},changeTimeSession:function(b){if(b){var c=this.formatJSONDate(b,"g:i A"),a=c.split(" ");if(a.length>0){str='<div class="detail-time-p-headerdetailevent">'+a[0]+'</div><div class="type-time-p-headerdetailevent">'+a[1].toUpperCase()+"</div>"}return str}return b},changeTimeMySession:function(b){if(b){var c=this.formatIso8601Date(b,"g:i A"),a=c.split(" ");if(a.length>0){str='<div class="detail-time-p-headerdetailevent">'+a[0]+'</div><div class="type-time-p-headerdetailevent">'+a[1].toUpperCase()+"</div>"}return str}return b},getSeatsRemaining:function(a){if(a.trim()=="Sold Out"||a.trim()=="Cancelled"||a.trim()=="Wait List"){return a}else{if(parseInt(a)>10){return"Seats Remaining: "+parseInt(a)}else{return'Seats Remaining: <span class="p-phone-text-red">0'+parseInt(a)+"</span>"}}},isSoldOutEvent:function(a){return(a.trim()=="Sold Out")?"p-phone-icon-soulOut":""},isMemberOnlyEvent:function(a){return(a==false)?"":"p-phone-icon-member"},roundMinutes:function(b){var a=new Date(b);a.setHours(a.getHours()+1);a.setMinutes(0);a.setSeconds(0);return a},oneHourLater:function(b){var a=new Date(b);a.setHours(a.getHours()+2);a.setMinutes(0);a.setSeconds(0);return a},oneDateLater:function(b){var a=new Date(b);a.setDate(a.getDate()+1);return a},getSelectDateTimeValue:function(c){var d=this.getMonthEventView(c);var e=Ext.Date.format(c,"m");var b=this.getYearEventView(c);var a=d+", "+b;return a},getSelectTimeSessionValue:function(a){return Ext.Date.format(a,"g a")},compareTwoDays:function(e,b){var a=this.getMonthEventView(e);var d=this.getMonthEventView(b);var f=this.getYearEventView(e);var c=this.getYearEventView(b);return(a==d&&f==c)?true:false},convertStringToDate:function(b){var c=null;if(b){var a=b.split(/[-T:]/g);c=new Date(a[0],a[1]-1,a[2]);c.setHours(a[3],a[4],a[5])}return c},convertStringToDateSession:function(a){if(a){return new Date(a)}},getWidthPrice:function(c,b,a){var d=null;var e=0;if(parseInt(c).toString().length>parseInt(b).toString().length){d=c}else{d=b}d=d.toString();if(parseInt(d.length/3)>1){e+=parseInt(d.length/3)}if(d.indexOf(".")!=-1){d=d.substring(0,d.indexOf("."))}e+=d.length+8;return e*a},getWidthOrderPrice:function(g,f,d,c,b,a){var j=0;var e=0;var k=[];k.push(g);k.push(f);k.push(d);k.push(c);k.push(b);for(var h=0;h<k.length;h++){if(k[h]&&parseInt(k[h]).toString().length>parseInt(j).toString().length){j=k[h]}}j=j.toString();if(parseInt(j.length/3)>1){e+=parseInt(j.length/3)}if(j.indexOf(".")!=-1){j=j.substring(0,j.indexOf("."))}e=j.length+8;return e*a},getSponsorListFromJsonFile:function(a,d,e,f){var c=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("sponsorEvents");e.removeAll(true);for(var b=0;b<c.length;b++){if(c[b].ProductId==d){e.setData(c[b].SponsorImageList)}}f()},getAddress:function(e){var i=null;var f=e.get("streetAddress")?e.get("streetAddress")+", ":"";var c=e.get("address2")?e.get("address2")+", ":"";var b=e.get("address3")?e.get("address3")+", ":"";var j=e.get("address4")?e.get("address4")+", ":"";var g=e.get("locality")?e.get("locality")+", ":"";var h=e.get("region")?e.get("region")+", ":"";var a=e.get("postalCode")?e.get("postalCode")+", ":"";var d=e.get("country")?e.get("country"):"";i=f+c+b+j+g+h+a+d;return i},showAddressOnMaps:function(a){var c=this;var d=function(){var f="Currently the google maps can not be loaded. Please check your connection and try again after few minutes";if(!window.google){Ext.Msg.alert("Connection",f)}else{if(typeof google.maps.Geocoder!="function"){Ext.Msg.alert("Connection",f)}else{var e=new google.maps.Geocoder();c.callGeocoder(a,e)}}};if(!window.google){c.loadScript("https://maps.googleapis.com/maps/api/js?v=3&sensor=false&callback=isLoadSuccess");window.setTimeout(d,2500)}else{var b=new google.maps.Geocoder();c.callGeocoder(a,b)}},callGeocoder:function(a,b){var d=null,c=null;Ext.Viewport.setMasked({xtype:"loadmask"});b.geocode({address:a},function(h,f){Ext.Viewport.setMasked(false);if(f==google.maps.GeocoderStatus.OK){var j=[];var e=h[0].geometry.location;for(var i in e){if(hasOwnProperty.call(e,i)){j.push(i)}}d=h[0].geometry.location[j[0]];c=h[0].geometry.location[j[1]];if(Ext.os.is.Android){var k={};k.latitude=d;k.longitude=c;k.address=a;if(window.plugins.androidHelper){window.plugins.androidHelper.showOnMaps(k)}}else{var g="http://maps.google.com/?q=loc:"+d+","+c+"";window.open(g,"_blank","location=no,enableviewportscale=yes")}}})},loadScript:function(b){var a=document.createElement("script");a.src=b;a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a)},getMessageMatchTypeOfEvent:function(b){var a={};var c="Are you sure you want to delete the personal event from My Schedule?";var d="Personal event has been removed.";if(b.get("type").toUpperCase()=="MEETING"){c="Are you sure you want to delete the meeting from My Schedule?";d="Meeting has been removed.";if(b.get("sessionID").trim()!=""&&b.get("sessionID")!=0){c="Are you sure you want to delete the session from My Schedule?";d="Session has been removed."}}else{if(b.get("type").toUpperCase()=="PERSONAL"){if(b.get("meetingId").trim()!=""&&b.get("meetingId")!=0){c="Are you sure you want to delete the personal session from My Schedule?";d="Personal session has been removed."}}}a.msg=c;a.msgSuccess=d;return a},setCaretSelection:function(c,b,a){c.focus();c.setSelectionRange(b,a)},onShareEvent:function(a){if(window.plugins.social&&window.plugins.social.available){window.plugins.social.available(function(c){if(c==1){var b="";var i="";if(a){i=a.get("shortName");var f=Personify.utils.ItemUtil.formatJSONDate(Personify.utils.ItemUtil.convertStringToDate(a.get("startDateTimeString")));var g=Personify.utils.ItemUtil.formatJSONDate(Personify.utils.ItemUtil.convertStringToDate(a.get("startDateTimeString")),"g:i a");var e=Personify.utils.ItemUtil.formatJSONDate(Personify.utils.ItemUtil.convertStringToDate(a.get("endDateTimeString")),"g:i a");var h=g+" - "+e;var d=a.get("locationFullAddress").replace("\r\n"," ");b="Title: "+i+"\nDate: "+f+"\nTime: "+h+"\nLocation: "+d}window.plugins.social.share(b,"","")}else{Ext.Msg.alert("","Social network plugins is not supported.",Ext.emptyFn)}})}},onShareSessionDetail:function(a){if(window.plugins.social&&window.plugins.social.available){window.plugins.social.available(function(d){if(d==1){var c="";var i="";if(a){i=a.get("title");var b=new Date(a.get("startDateTimeString"));var h=new Date(a.get("endDateTimeString"));var e=a.get("locationDescription");var g=Personify.utils.ItemUtil.formatJSONDate(a.get("startDateTimeString"),"g:i a")+" - "+Personify.utils.ItemUtil.formatJSONDate(a.get("endDateTimeString"),"g:i a");var f=Personify.utils.ItemUtil.formatJSONDate(b)+" - "+Personify.utils.ItemUtil.formatJSONDate(h);c="Title: "+i+"\nDate: "+f+"\nTime: "+g+"\n";if(e&&e!=""){c+="Location: "+e}}window.plugins.social.share(c,"","")}else{Ext.Msg.alert("","Social network plugins is not supported.",Ext.emptyFn)}})}}}});