Ext.define("Personify.controller.event.simpleEvent.SimpleEventContent",{extend:"Personify.base.Controller",control:{simpleEventHeader:{addagenda:"addNewCustomerMeetingAgenda",deleteagenda:"onDeleteMeetingAgenda",onmaptap:"onTapMapItDetail"},cardMainDetailContainer:true,sponsorPanel:true},requires:["Personify.view.eventdescription.DescriptionContent","Personify.view.event.complexevent.detailsession.Rate"],init:function(){var a=this.getView().getRecord();this.setRecord(a)},setRecord:function(a){var d=this;if(a){var c=Ext.create("Personify.view.eventdescription.DescriptionContent",{record:a});var e=this.getCardMainDetailContainer();e.removeAll(true,true);e.add(c);this.getSimpleEventHeader().getController().setRecord(a);var b=a.SponsorListEvent;Personify.utils.ItemUtil.getSponsorListFromJsonFile(Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("sponsorEvents"),a.get("productID"),b,function(){if(b.getCount()>0){if(d.getSponsorPanel){d.getSponsorPanel().getController().setStore(b);d.getSponsorPanel().show()}}else{if(d.getSponsorPanel){d.getSponsorPanel().hide()}}})}},addNewCustomerMeetingAgenda:function(){if(!Personify.utils.PhoneGapHelper.checkConnection()){Ext.Msg.alert("Connection","Please check your internet connection.",Ext.emptyFn);return}Ext.Viewport.setMasked({xtype:"loadmask"});var c=this;var b=this.getView().getRecord();var a=Personify.utils.Configuration.getCurrentUser();a.addEventToSchedule(b).then({success:function(d){if(d){b.set("appointmentId",d.get("appointmentId"))}if(!b.get("isAdded")){b.set("isAdded",true)}c.getSimpleEventHeader().getController().updateAddRemoveButton(b);c.refreshDataAgenda();Ext.Msg.alert("","Meeting has been added to your schedule.")},failure:function(){Ext.Msg.alert("","Error occurred while adding to your schedule.")}}).always(function(){Ext.Viewport.setMasked(false)})},onDeleteMeetingAgenda:function(){var a=this.getView().getRecord();this.getView().getParent().fireEvent("deletesession",a,this.getView())},refreshDataAgenda:function(){this.getView().getParent().fireEvent("refreshmyschedule")},onTapMapItDetail:function(){var a=this.getView().getRecord();this.getView().getParent().fireEvent("buttonmapittap",a)}});