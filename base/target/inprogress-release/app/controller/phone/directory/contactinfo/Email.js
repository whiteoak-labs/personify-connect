Ext.define("Personify.controller.phone.directory.contactinfo.Email",{extend:"Personify.controller.profile.Email",requires:["Personify.view.phone.directory.contactinfo.EmailList","Personify.view.phone.directory.contactinfo.EmailEditForm"],config:{typeList:null,typeListToRemove:null,recordsForDelete:new Array(),errorMessage:"\n- Wrong email format:",blankErrorMessage:"- Email field cannot be empty"},control:{infoContainer:{typelistchange:"onTypeListChange",textboxchange:"onTextboxChange",deleteCommand:"onDeleteCommand"},emailTitle:true},setRecord:function(a){if(a){if(this.getIsEditing()){this.updateEditMode(true);return}if(a.EntryProfile.getAt(0).EmailsProfile.getCount()>0){this.getInfoContainer().removeAll(true,true);var b=Ext.create("Personify.view.phone.directory.contactinfo.EmailList",{scrollable:null,disableSelection:true});b.setStore(a.EntryProfile.getAt(0).EmailsProfile);this.getInfoContainer().add(b);this.getView().setHidden(false)}else{this.getView().setHidden(true)}}},updateEditMode:function(d){var c=this;c.getView().setHidden(false);c.getInfoContainer().removeAll(true,true);if(d==true){var e=new Array(),a=c.getView().getRecord(),b=a.EntryProfile.getAt(0).EmailsProfile;c.setTypeList(a.get("emailLocationList").split(","));b.each(function(f){var g=Ext.create("Personify.view.phone.directory.contactinfo.EmailEditForm");g.getController().setTypeList(c.getTypeList());g.setRecord(f);c.getInfoContainer().add(g);e.push(f.get("type"))});c.setTypeListToRemove(e);c.addEmptyItem();c.updateTypeListForAllEditItems()}else{c.setRecord(c.getView().getRecord())}},addEmptyItem:function(){var b=this.checkTypeList();if(b.length==0){this.setCanAddMoreFlag(false);return}else{this.setCanAddMoreFlag(true)}var a=this.getInfoContainer();var b=Ext.Array.difference(this.getTypeList(),this.getTypeListToRemove());var c=Ext.create("Personify.view.phone.directory.contactinfo.EmailEditForm");c.getController().setTypeList(b);this.getTypeListToRemove().push(b[0]);a.add(c)},updateTitleClass:function(a){this.getEmailTitle().setCls(a)}});