Ext.define("Personify.controller.phone.map.MapNavigation",{extend:"Personify.base.Controller",requires:["Personify.view.event.map.PinchZoomImage"],control:{menumappanel:{back:"onBackMenuMapPanel"},mapdetail:{back:"onBackMapDetail"}},init:function(){var c=this;var d=this.getView().getLocationData();var a=null;var b=this.getView();this.getMenumappanel().getController().setRecord(b.getRecord());if(d){var e=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("mapData");c.initMap(e,d)}else{b.animateActiveItem(0,{type:"slide",direction:"left"})}},initMap:function(h,f){var b=this.getView();var a=h.locations[f];if(a){var d=a.mapId;for(var c=0;c<h.maps.length;c++){if(h.maps[c].mapId==d){b.animateActiveItem(1,{type:"slide",direction:"left"});var g=b.getActiveItem();g.removeAt(1);var e=g.add({xtype:"pinchzoomimage",src:h.maps[c].image,width:"100%",hight:"100%",flex:1});e.updateMarkerPosition({x:a.coords[0],y:a.coords[1]});g.items.items[0].setTitle(h.maps[c].name)}}}else{b.animateActiveItem(0,{type:"slide",direction:"left"})}},onBackMenuMapPanel:function(){this.getView().fireEvent("back",this)},onBackMapDetail:function(){var a=this.getView().getLocationData();if(a){this.getView().fireEvent("back",this)}else{this.getView().animateActiveItem(0,{type:"slide",direction:"right"})}}});