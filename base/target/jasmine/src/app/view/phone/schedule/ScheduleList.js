Ext.define("Personify.view.phone.schedule.ScheduleList",{extend:"Ext.dataview.List",xtype:"myschedulelistphone",requires:["Personify.controller.phone.schedule.ScheduleList","Personify.view.phone.schedule.ScheduleItem"],controller:"Personify.controller.phone.schedule.ScheduleList",config:{baseCls:"p-phone-list-event",pressedCls:"p-phone-common-list-selected",selectedCls:"p-phone-common-list-selected",itemCls:"p-item-list-event",xtype:"list",grouped:true,deferEmptyText:false,onItemDisclosure:true,emptyText:'<div class="phone-emptyText">Currently, there are no events in your schedule. <br> You may add an event by selecting an event and choosing ‘Add to My Schedule’</div>',itemTpl:null,listeners:{itemtap:function(b,d,f,c,g,h){g.preventDefault();var i=b.getStore();var k=this.getGroupOfrecord(c);var j=i.getGroups();var a=this.getGroupValue(k,j);if(g.target.className.indexOf("p-phone-list-event-header")>=0){if(g.target.className.indexOf("p-list-expand")>=0){this.hiddenRecord(a);g.target.classList.remove("p-list-expand")}else{this.showRecord(a);g.target.classList.add("p-list-expand")}}else{this.fireEvent("eventitemlistselect",b,d,f,c,g,h)}}}},initialize:function(){var a=Ext.create("Personify.view.phone.schedule.ScheduleItem");this.setItemTpl(new Ext.XTemplate(a.element.dom.innerHTML));this.callParent(arguments);a.destroy()},getGroupOfrecord:function(b){var a=b.get("startDateTime");var d=Personify.utils.ItemUtil.getMonthEventView(a);var e=Ext.Date.format(a,"m");var c=Personify.utils.ItemUtil.getYearEventView(a);return'<span style="color:transparent;display:none!important">'+c+","+e+"</span>"+d+" "+c},getGroupValue:function(c,a){for(var b=0;b<a.length;b++){if(a[b].name==c){return a[b].children}}return null},hiddenRecord:function(b){var a=this.getStore();for(var d=0;d<b.length;d++){var c=a.indexOf(b[d]);var f=this.getItems().items[0].element.dom.childNodes[c];var e=null;if(f.className.indexOf("p-phone-list-event-header-item")>=0){e=f.childNodes[1].classList}else{e=f.childNodes[0].classList}e.add("p-hiddenCls")}this.doRefreshHeaders()},showRecord:function(b){var a=this.getStore();for(var d=0;d<b.length;d++){var c=a.indexOf(b[d]);var f=this.getItems().items[1].element.dom.childNodes[c];var e=null;if(f.className.indexOf("p-phone-list-event-header-item")>=0){e=f.childNodes[1].classList}else{e=f.childNodes[0].classList}e.remove("p-hiddenCls")}},updateHeaderCls:function(){if(this.getItems().items[1]){for(var a=0;a<this.getItems().items[1].element.dom.childNodes.length;a++){var b=this.getItems().items[1].element.dom.childNodes[a];if(b.className.indexOf("p-phone-list-event-header-item")>=0){if(b.childNodes[1].className.indexOf("p-hiddenCls")<0){b.childNodes[0].classList.add("p-list-expand")}else{b.childNodes[0].classList.remove("p-list-expand")}}}}},doRefreshHeaders:function(){this.updateHeaderCls()}});