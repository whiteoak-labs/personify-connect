Ext.define("Personify.store.jsonp.ProductList",{extend:"Personify.store.base.product.ProductList",requires:["Personify.model.jsonp.product.ProductList","Personify.proxy.RestService"],config:{storeId:"ProductList",model:"Personify.model.jsonp.product.ProductList",implicitIncludes:true,productItemStore:null,listeners:{beforeload:"onBeforeLoad",load:"loadData"}},onBeforeLoad:function(){var b=this.getDataRequest();var a={type:"restservice",dataRequests:b,url:Personify.utils.ServiceManager.getUrlWS("storeProducts"),headers:Personify.utils.ServiceManager.getHeaders(),jsonData:b,reader:{type:"json"}};this.setProxy(a)},loadData:function(a,b){if(b.length>0){if(a.getDataRequest().ItemsPerPage<b[0].getData().totalResults){a.getDataRequest().ItemsPerPage=b[0].getData().totalResults}else{a.setProductItemStore(Ext.create("Personify.store.jsonp.Product"));if(a.getData().items[0]!=null){a.getProductItemStore().add(a.getData().items[0].ProductItem.getData().items)}}}}});