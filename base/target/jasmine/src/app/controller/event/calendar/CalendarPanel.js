Ext.define("Personify.controller.event.calendar.CalendarPanel",{extend:"Personify.base.Controller",requires:["Ext.ux.TouchCalendarView"],config:{selectedDate:null},control:{calendarButton:{changecalendarview:"onChangeCalendarView"},calendar:{selectiondatechange:"onSelectDateCell"},calendarText:{}},init:function(){this.onLoadCalendarData(null)},onChangeCalendarView:function(a,b){this.setSelectedDate(a);this.onChangeCalendarBox(a,b);this.getView().fireEvent("onchangecalendarview",a)},onChangeCalendarBox:function(b,c){this.setSelectedDate(b);var d=this.getCalendar().child("CalendarBox");var a=Personify.utils.ItemUtil.getMonthsBetweenTwoDates(b,c);d.refreshDelta(a)},onLoadCalendarData:function(a){var b={xtype:"CalendarBox",viewMode:"month",startEventField:"startDateTime",endEventField:"endDateTime",weekStart:0,eventStore:a,plugins:[Ext.create("Ext.ux.TouchCalendarSimpleEvents")]};this.getCalendar().removeAll(true);this.getCalendar().add(b)},onSelectDateCell:function(a){this.getView().fireEvent("selectiondatechange",a)},onBackCurrentDate:function(){this.onRemoveSelectDate();this.getCalendarButton().getController().onShowCurrentDate()},onRemoveSelectDate:function(){this.getCalendar().child("CalendarBox").removeSelectCell()},setTextOrHideCalendarText:function(a){if(a){this.getCalendarText().setHtml(a)}else{this.getCalendarText().hide()}}});