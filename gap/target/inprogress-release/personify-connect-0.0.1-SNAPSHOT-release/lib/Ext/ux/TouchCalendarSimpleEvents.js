Ext.define("Ext.ux.TouchCalendarSimpleEvents",{extend:"Ext.mixin.Observable",startEventField:"startDateTime",endEventField:"endDateTime",multiEventDots:true,wrapperCls:"simple-event-wrapper",eventDotCls:"simple-event",dotWidth:6,eventTpl:['<span class="{wrapperCls}">','<tpl for="events">','<span class="{[parent.eventDotCls]}"></span>',"</tpl>","</span>"].join(""),filterFn:function(c,e,b){if(arguments.length===2){b=e}var a=Ext.Date.clearTime(this.formatDate(c.get(this.startEventField)),true).getTime(),d=Ext.Date.clearTime(this.formatDate(c.get(this.endEventField)),true).getTime(),b=Ext.Date.clearTime(b,true).getTime();return(a<=b)&&(d>=b)},init:function(a){this.calendar=a;this.calendar.simpleEventsPlugin=this;this.calendar.showEvents=this.showEvents;this.calendar.hideEvents=this.hideEvents;this.calendar.removeEvents=this.removeEvents;this.calendar.refresh=Ext.Function.createSequence(this.calendar.refresh,this.refreshEvents,this);this.calendar.syncHeight=Ext.Function.createSequence(this.calendar.syncHeight,this.refreshEvents,this)},refreshEvents:function(){if(!this.disabled){var c=this.calendar.getStore();var a=this.calendar.eventStore;if(a){var b=0;if(c){this.removeEvents();c.each(function(e){var f=e.get("date");var d=this.calendar.getDateCell(f);if(d){var g=this;a.each(function(j){var h=Ext.Date.clearTime(j.get("startDateTime")).getTime();var n=Ext.Date.clearTime(j.get("endDateTime")).getTime();var i=f.getTime();var m=j.get("registered");if((h<=i)&&(n>=i)){var k=new Ext.XTemplate(g.eventTpl).append(d,{events:(g.multiEventDots?a.getRange().slice(0,1):["event"]),wrapperCls:g.wrapperCls,eventDotCls:m?"simple-schedule":g.eventDotCls},true);var l=m?d.getWidth()/3:d.getWidth()*2/3;k.setX((d.getX()+l));k.setY((d.getY()+d.getHeight())-(k.getHeight()+(d.getHeight()*0.1)))}})}a.clearFilter();b++},this)}}}},hideEvents:function(){this.simpleEventsPlugin.disabled=true;this.calendar.element.select("span."+this.wrapperCls).hide()},showEvents:function(){this.simpleEventsPlugin.disabled=false;this.calendar.element.select("span."+this.wrapperCls).show()},removeEvents:function(){if(this.calendar.element){this.calendar.element.select("span."+this.wrapperCls).clear()}},formatDate:function(a){var b=xmlDate.split(/[-T:]/g);var c=new Date(b[0],b[1]-1,b[2]);c.setHours(b[3],b[4],b[5]);return c}});