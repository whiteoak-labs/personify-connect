Ext.define("Personify.controller.phone.event.ConferenceMenu",{extend:"Personify.base.Controller",config:{menuStore:null},control:{menuToolbar:{onNavigationButtonTap:"onBack"},menuList:{itemtap:"onMenuItemTapped"},titleEventOfConferenceMenu:true,imageEvent:true,sponsorCarousel:true},init:function(){this.getMenuToolbar().getController().setHiddenActionButton(true);var b=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("conferenceImageWidth");var a=Personify.utils.Configuration.getConfiguration().getAt(0).EventsStore.get("conferenceImageHeight");if(b){this.getImageEvent().setWidth(b)}if(a){this.getImageEvent().setHeight(a)}},setDataSponsorCarousel:function(c){var d=this.getSponsorCarousel();for(var b=0;b<c.getCount();b++){var e=c.getAt(b).getData().phoneImageURL;var a='<div style = "text-align: center" ><a href = "'+c.getAt(b).getData().redirectURL+'"><img alt = "'+c.getAt(b).getData().sponsorName+'" src = "'+e+'" width="auto" height="45px"/></a></div>';d.add({html:a})}if(d.getItems().getCount()!=1){d.show();d.setActiveItem(0)}else{this.getMenuList().setMargin("0 0 45 0")}},setRecord:function(a){this.getImageEvent().setSrc(a.get("imageURL"));this.getTitleEventOfConferenceMenu().setHtml(Personify.utils.ItemUtil.getShortContent(a.get("shortName"),75))},onUpdateValue:function(a,b,d){this.getView().setRecord(a);this.getView().setStore(b);this.getView().setTitle(d);this.setTitle(d);if(b!=null){var c=Ext.create("Personify.store.base.EventMenu");b.each(function(e){c.add(e)});this.setMenuStore(b);this.setStore(c)}},onBack:function(){this.getView().fireEvent("backtoevent",this)},onMenuItemTapped:function(g,b,f,a,d,c){var e=this.getView().getRecord();this.getView().fireEvent("requestopendetail",a.get("view"),{record:e,eventId:e.get("productID")})},setStore:function(a){this.getMenuList().setStore(a)},setTitle:function(a){this.getMenuToolbar().setTitle("Conference");this.getMenuToolbar().getTitle().setCls("p-phone-title-toolbar")},updateMenu:function(e){if(e&&e!=null){var d=Personify.utils.Configuration.getCurrentUser();var f=d?d.isStaffMember():false;var b=e.MeetingRegistrantStore?e.MeetingRegistrantStore.getCount():0;var g=e.ExhibitorStore?e.ExhibitorStore.getCount():0;var i=e.MaterialStore?e.MaterialStore.getCount():0;var h=e.SpeakersListEvent?e.SpeakersListEvent.getCount():0;var c=this.getMenuStore();var a=Ext.create("Personify.store.base.EventMenu");c.each(function(j){a.add(j)});this.getMenuList().setStore(a);if(b==0){this.removeMenuItem("attendees")}else{if(f||e.get("registered")){}else{this.removeMenuItem("attendees")}}if(i==0){this.removeMenuItem("materials")}if(g==0){this.removeMenuItem("exhibitors")}if(h==0){this.removeMenuItem("presenters")}if(e.get("badgeData")==""){this.removeMenuItem("badge")}}},removeMenuItem:function(b){var a=this.getMenuList().getStore();a.each(function(c){if(c.get("menuItem")==b){a.remove(c)}})}});