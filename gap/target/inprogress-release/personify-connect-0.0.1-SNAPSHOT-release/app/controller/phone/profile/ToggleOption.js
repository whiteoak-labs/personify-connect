Ext.define("Personify.controller.phone.profile.ToggleOption",{extend:"Personify.controller.profile.ToggleOption",control:{toggleDirectory:{change:"onUpdateOption"},toggleMobileDirectory:{change:"onUpdateOption"},view:{painted:"onPainted"}},config:{record:null,flagUpdatingRecord:false,tempRecord:null,flagInitToggle:true},onPainted:function(){var a=this;if(a.getFlagInitToggle()){window.setTimeout(function(){var c=a.getTempRecord();var b=a.getToggleDirectory(),d=a.getToggleMobileDirectory();if(c){a.setFlagUpdatingRecord(true);b.setValue(c.get("includeInDirectory"));d.setValue(c.get("includeInMobileDirectory"));a.setFlagUpdatingRecord(false)}else{b.setValue(false);d.setValue(false)}a.getView().setMasked(false);a.setFlagInitToggle(false)},500)}},init:function(){this.callParent(arguments)},updateRecord:function(b){if(this.getFlagInitToggle()){this.setTempRecord(b);return null}var a=this.getToggleDirectory(),c=this.getToggleMobileDirectory();if(b){this.setFlagUpdatingRecord(true);a.setValue(b.get("includeInDirectory"));c.setValue(b.get("includeInMobileDirectory"));this.setFlagUpdatingRecord(false)}else{a.setValue(false);c.setValue(false)}this.getView().setMasked(false)},onUpdateOption:function(o,p,q,k,n,a){if(!this.getFlagUpdatingRecord()){var u=this,j=Personify.utils.Configuration.getCurrentUser(),c=u.getToggleDirectory(),t=u.getToggleMobileDirectory(),d=Personify.utils.ServiceManager.getStoreManager(),h=d.getCustomerStore(),i=Ext.create(h),r=false,e=false,f=false,b=false;var s={Type:this.getRecord().get("type")||"I",MasterCustomerId:j.get("masterCustomerId"),SubCustomerId:j.get("subCustomerId"),OrganizationId:j.get("organizationId"),OrganizationUnitId:j.get("organizationUnitId"),IncludeInDirectory:(c.getValue()==1),IncludeInMobileDirectory:(t.getValue()==1)};var d=Personify.utils.ServiceManager.getStoreManager();var m=d.getProfileUpdatingStore();var g=Ext.create(m,{dataRequest:s});var l=this.getView();l.setMasked({xtype:"loadmask"});g.load({callback:function(w,v,y){if(y&&w.length){var x=w[0];if(x&&x.EntryProfile.getCount()){l.setRecord(x);u.setRecord(x.EntryProfile.first())}else{o.setValue(n)}}else{}l.setMasked(false)}})}}});