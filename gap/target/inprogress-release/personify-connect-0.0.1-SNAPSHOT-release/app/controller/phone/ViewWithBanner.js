Ext.define("Personify.controller.phone.ViewWithBanner",{extend:"Personify.base.Controller",inject:["currentUser"],requires:"Personify.view.phone.login.LoginPhone",config:{currentUser:null},control:{logInButton:{tap:"onLogInButtonTap",submitLogin:"onLogInButtonTap"},mainViewContainer:{},homeMainView:{listeners:{requestchangemainview:"onRequestChangeMainView",requestchangeview:"onRequestChangeView",updatecurrentuser:"onUpdateCurrentUser"}}},init:function(){this.onUpdateCurrentUser(this.getCurrentUser())},openView:function(a,b,f,c){if(b){if(b.record&&b.record.get("neededLogin")&&!this.getCurrentUser().isLogged()){Personify.utils.ItemUtil.needToLogin();return}}if(b&&b.hasOwnProperty("loginButtonHidden")&&b.loginButtonHidden==false){this.getLogInButton().show()}if(typeof a=="string"){a=Ext.create(a,b)}a.addListener("updatecurrentuser",this.onUpdateCurrentUser,this);a.addListener("requestchangemainview",this.onRequestChangeMainView,this);if(b&&b.record){var d=b.record.get("listeners");if(d){for(var e in d){this.getView().addListener(e,d[e],a)}}}this.getView().fireEvent("requestchangeview",a,null)},onRequestChangeMainView:function(a,b,d,c){this.openView(a,b,d,c)},onRequestChangeView:function(a,b){this.getView().fireEvent("requestchangeview",a,b)},onUpdateCurrentUser:function(a,b){this.getView().fireEvent("updatecurrentuser",a,function(){if(b){b(true)}})},updateViewForUser:function(a){this.setCurrentUser(a);var b=this.getLogInButton();if(a.isLogged()){b.setHidden(true)}else{b.setHidden(false)}this.getHomeMainView().getController().onUpdateCurrentUser(a)},onLogInButtonTap:function(){this.onRequestChangeMainView("Personify.view.phone.login.LoginPhone",null)}});