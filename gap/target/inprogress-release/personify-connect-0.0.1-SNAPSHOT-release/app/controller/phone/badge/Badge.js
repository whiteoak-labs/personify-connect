Ext.define("Personify.controller.phone.badge.Badge",{extend:"Personify.base.Controller",control:{badgeCode:{},badgeName:{},badgeJobTitle:{},badgeAssociation:{},badgeTitleBar:{},ptoolbarBadgePanelPhone:{onNavigationButtonTap:"onTapNavigationButton"},view:{painted:"onPainted"}},init:function(){this.getPtoolbarBadgePanelPhone().getController().getActionButton().setText("More");this.getPtoolbarBadgePanelPhone().getController().setHiddenActionButton(true);var a=this.getView().getRecord();var b="";if(a.get("shortName")){b=a.get("shortName")}else{if(a.get("title")){b=a.get("title")}}this.getBadgeTitleBar().setHtml(Personify.utils.ItemUtil.getShortContent(b,48));this.getData()},onTapNavigationButton:function(){this.getView().fireEvent("back",this)},onPainted:function(){var a=this.getView().getRecord();var c=a.get("badgeData");var b=this.getBadgeCode().element.id;jQuery("#"+b).qrcode({width:180,height:180,text:c})},getData:function(){var g=this,f=g.getView(),h=Personify.utils.ServiceManager.getStoreManager(),e=Ext.create(h.getProfileStore()),a=Personify.utils.Configuration.getCurrentUser(),d=a.getProfileDisplayOptionStore();var c=a.isStaffMember(),b={MasterCustomerId:a.get("masterCustomerId"),SubCustomerId:a.get("subCustomerId"),ReqMasterCustomerId:a.get("masterCustomerId"),ReqSubCustomerId:a.get("subCustomerId"),IsStaff:c,RecordType:""};e.setDataRequest(b);e.on("load",function(k,j){var i=e.getAt(0).EntryProfile.getData().getAt(0);g.getBadgeJobTitle().setHtml(i.get("jobTitle"));g.getBadgeName().setHtml(i.get("displayName"))});e.load()}});