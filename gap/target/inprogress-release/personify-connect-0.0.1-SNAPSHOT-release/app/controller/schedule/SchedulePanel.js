Ext.define("Personify.controller.schedule.SchedulePanel",{extend:"Personify.base.Controller",config:{isButtonHide:true,havePast:false},control:{eventlisting:{itemtouchstart:"onItemTouchStart",itemtouchend:"onItemTouchEnd"}},init:function(){},onItemTouchStart:function(b,c,g,a,f,d){if(f.target.className.indexOf("x-button")<0){g.addCls("x-item-pressed")}},onItemTouchEnd:function(b,c,g,a,f,d){g.removeCls("x-item-pressed")},setStore:function(a){if(a.getCount()<=0){this.getEventlisting().setEmptyText('<div class="emptyText">Currently, there are no events in your schedule. <br> You may add an event by selecting an event and choosing ‘Add to My Schedule’</div>')}this.getEventlisting().getController().setStore(a)},getStore:function(){return this.getEventlisting().getStore()},onTapSearchButton:function(b){var a=this.getEventlisting().getStore();a.filter(function(c){didMatch=(c.get("title").trim().toLowerCase()+" "+c.get("description").trim().toLowerCase()+" "+c.get("type").trim().toLowerCase()+" "+c.get("speakerName").trim().toLowerCase()).match(b.trim().toLowerCase());if(didMatch){return c}});this.getEventlisting().getController().showPastEvent(a)},onSelectionDateChange:function(b){var a=this.getEventlisting().getStore();if(b){a.filter(function(d){var c=d.get("startDateTime");var e=new Date(c);e.setHours(0,0,0,0);var f=d.get("endDateTime");if(e<=b&&f>=b){return d}})}this.getEventlisting().getController().showPastEvent(a)},onChangeCalendarView:function(a){var b=this.getEventlisting().getStore();if(a){b.filter(function(d){var c=d.get("startDateTime");var e=d.get("endDateTime");if(c.getFullYear()*100+c.getMonth()<=a.getFullYear()*100+a.getMonth()&&a.getFullYear()*100+a.getMonth()<=e.getFullYear()*100+e.getMonth()){return d}})}this.getEventlisting().getController().showPastEvent(b)},onSubmitFilter:function(f){var b=this.getEventlisting().getStore();var h=f.EventFormatListCountStore;var e=f.LocationListCountStore;var g=f.TopicListCountStore;if(h&&h.getAllCount()>0){}if(e&&e.getAllCount()>0){var a=new Array();e.each(function(i){if(i.get("checked")=="checked"){a.push(i.get("code"))}});if(a.length>0){b.filter(function(j){var k=true;for(var l=0;l<a.length;l++){if(j.get("locationState")!=a[l]){k=false}}if(k){return j}})}}if(g&&g.getAllCount()>0){var c=new Array();var d=new Array();g.each(function(i){if(i.get("checked")=="checked"){c.push(i.get("code"));var j=new Array();if(i.SubcodeListEvent){i.SubcodeListEvent.each(function(k){if(k.get("checked")=="checked"){j.push(k.get("code"))}})}d.push(j)}});if(c.length>0){b.filter(function(j){var k=true;var n=j.TopicListEvent;var m=new Array();for(var l=0;l<c.length;l++){m.push(c[l])}n.each(function(i){Ext.Array.remove(m,i.get("code"))});if(m.length!=0){k=false}else{n.each(function(o){var p=Ext.Array.indexOf(c,o.get("code"));var i=d[p];if(i&&i.length>0){var q=o.SubcodeListEvent;q.each(function(r){Ext.Array.remove(i,r.get("code"))});if(i.length!=0){k=false}}})}if(k&&n.getAllCount()>0){return j}})}}},onClearFilterListevent:function(){var a=this.getEventlisting().getStore();a.clearFilter();this.getEventlisting().getController().hidePastEvent(a)}});