Ext.define("Personify.view.schedule.ScheduleList",{extend:"Ext.dataview.DataView",xtype:"myschedulelist",requires:["Personify.controller.schedule.ScheduleList","Personify.view.schedule.ScheduleItem"],controller:"Personify.controller.schedule.ScheduleList",config:{cls:"panel-left ",itemId:"listEventItem",xtype:"list",scrollable:null,grouped:true,baseCls:"p-list-event-new",pressedCls:"",selectedCls:"",disableSelection:true,deferEmptyText:false,itemTpl:null,listeners:{itemtap:function(b,d,f,c,g,h){g.preventDefault();var k=b.getStore();var m=this.getGroupOfrecord(c);var l=k.getGroups();var a=this.getGroupValue(m,l);var j=this;if(g.target.className.indexOf("p-list-event-new-header")>=0){if(g.target.className.indexOf("p-list-expand")>=0){this.hiddenRecord(a);g.target.classList.remove("p-list-expand")}else{this.showRecord(a);g.target.classList.add("p-list-expand")}}else{if(g.target.className.indexOf("x-button")>=0){if(!Personify.utils.PhoneGapHelper.checkConnection()){Ext.Msg.alert("Connection","Please check your internet connection.",Ext.emptyFn);return}var n=Personify.utils.ItemUtil.getMessageMatchTypeOfEvent(c);Ext.Msg.confirm("",n.msg,i);function i(e){Ext.Msg.hide();if(e=="yes"){j.getParent().fireEvent("removeagenda",c,n.msgSuccess)}}}else{this.getParent().fireEvent("scheduleitemselect",c)}}}}},hiddenRecord:function(b){var a=this.getStore();for(var d=0;d<b.length;d++){var c=a.indexOf(b[d]);var f=this.getItems().items[0].element.dom.childNodes[c];var e=null}},showRecord:function(b){var a=this.getStore();for(var d=0;d<b.length;d++){var c=a.indexOf(b[d]);var f=this.getItems().items[0].element.dom.childNodes[c];var e=null}},getGroupOfrecord:function(b){var a=b.get("startDateTime");var d=Personify.utils.ItemUtil.getMonthEventView(a);var e=Ext.Date.format(a,"m");var c=Personify.utils.ItemUtil.getYearEventView(a);return'<span style="color:transparent;display:none!important">'+c+","+e+"</span>"+d+" "+c},getGroupValue:function(c,a){for(var b=0;b<a.length;b++){if(a[b].name==c){return a[b].children}}return null},updateHeaderCls:function(){if(this.getItems().items[0]){for(var a=0;a<this.getItems().items[0].element.dom.childNodes.length;a++){var b=this.getItems().items[0].element.dom.childNodes[a];if(b.className.indexOf("p-list-event-new-header-item")>=0){if(b.childNodes[1].className.indexOf("p-hiddenCls")<0){b.childNodes[0].classList.add("p-list-expand")}}}}},doRefreshHeaders:function(){this.callParent(arguments);this.updateHeaderCls()},initialize:function(){var a=Ext.create("Personify.view.schedule.ScheduleItem");this.setItemTpl(new Ext.XTemplate(a.element.dom.innerHTML,{getType:function(b){var d=b.type;var c=b.meetingId;var e=b.sessionID;if(d.toUpperCase()=="PERSONAL"){return"PERSONAL "}else{if(e&&e!=0){return"SESSION "}else{return"MEETING"}}}}));this.callParent(arguments);a.destroy()}});